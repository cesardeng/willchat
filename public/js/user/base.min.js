var Base=function(){var e=function(){$("form").not(".validate").submit(function(e){var t=$(this).attr("action"),i=$(this).serialize();return $.ajax({url:t,type:"POST",dataType:"json",data:i}).done(function(e,t,i){var a=$("form");a.find(".alert").remove(),this.success(e.info),e.url?setTimeout(function(){top.location.href=e.url},2e3):setTimeout(function(){top.location.reload()},2e3)}).fail(function(e,t,i){var a=e.responseJSON,o=$("form");o.find(".alert").remove(),$.each(a,function(e,t){var i=t[0],a=$('<div class="alert alert-danger alert-dismissable"><button type="button" class="close" data-dismiss="alert" aria-hidden="true"></button><strong>验证错误!</strong> '+i+" </div>");o.prepend(a)})}).always(function(){console.log("complete")}),!1})},t=function(){$("img.preview-small,.thumbnail img").click(function(e){var t=$(this).attr("src"),i="<img src='"+t+"' height='300'/>";layer.open({type:1,title:!1,fix:!1,shadeClose:!0,offset:["150px",""],area:["auto","auto"],content:i})})},i=function(){$(".group-checkable").click(function(){$(".ids").prop("checked",this.checked),$(".group-checkable,.ids").uniform()}),$(".ids").click(function(){var e=$(".ids");e.each(function(e){return this.checked?($(".group-checkable").prop("checked",!0),void $(".group-checkable,.ids").uniform()):($(".group-checkable").prop("checked",!1),$(".group-checkable,.ids").uniform(),!1)})})};$(".ajax-get").click(function(){var e;return!($(this).hasClass("confirm")&&!s("确认要执行该操作吗?"))&&(((e=$(this).attr("href"))||(e=$(this).attr("url")))&&$.get(e).success(function(e){1==e.status?(e.url?this.success(e.info+" 页面即将自动跳转~"):this.success(e.info),setTimeout(function(){e.url?location.href=e.url:location.reload()},1500)):(this.error(e.info),setTimeout(function(){e.url&&(location.href=e.url)},1500))}),!1)}),$(".ajax-post").click(function(){var e,t,i,a=$(this).attr("target-form"),o=this,n=!1;if("submit"==$(this).attr("type")||(e=$(this).attr("href"))||(e=$(this).attr("url"))){if(i=$("."+a),"true"===$(this).attr("hide-data"))i=$(".hide-data"),t=i.serialize();else{if(void 0==i.get(0))return!1;if("FORM"==i.get(0).nodeName){if($(this).hasClass("confirm")&&!s("确认要执行该操作吗?"))return!1;e=void 0!==$(this).attr("url")?$(this).attr("url"):i.get(0).action,t=i.serialize()}else if("INPUT"==i.get(0).nodeName||"SELECT"==i.get(0).nodeName||"TEXTAREA"==i.get(0).nodeName){if(i.each(function(e,t){"checkbox"==t.type&&1==t.checked&&(n=!0)}),n&&$(this).hasClass("confirm")&&!s("确认要执行该操作吗?"))return!1;t=i.serialize()}else{if($(this).hasClass("confirm")&&!s("确认要执行该操作吗?"))return!1;t=i.find("input,select,textarea").serialize()}}$(o).addClass("disabled").attr("autocomplete","off").prop("disabled",!0),$.post(e,t).success(function(e){1==e.status?(e.url?this.success(e.info+" 页面即将自动跳转~"):this.success(e.info),setTimeout(function(){$(o).removeClass("disabled").prop("disabled",!1),e.url?location.href=e.url:location.reload()},1500)):(this.error(e.info),setTimeout(function(){$(o).removeClass("disabled").prop("disabled",!1),e.url&&(location.href=e.url)},1500))})}return!1});var a=function(){var e=$(".sidebar-menu").find(".treeview a");if(e.length>0){var t=document.URL,i=$(".sidebar-menu .treeview").find("a[href='"+t+"']").first();if(i){var a=e.index(i);i.parents(".treeview").addClass("active"),i.parent("li").addClass("active"),Cookies.set("menuindex",a)}else{var a=Cookies.get("menuindex");i=e.eq(a),i.parents(".treeview").addClass("active"),i.parent("li").addClass("active")}}},o=function(e){top.layer.msg(e,{icon:1})},n=function(e){top.layer.msg(e,{icon:2,shift:6})},r=function(e){top.layer.msg(e)},s=function(e,t){top.layer.confirm(e,{icon:3,title:"操作提示"},function(e){t(),top.layer.close(e)})},c=function(){this.loadingIndex=top.layer.load()},l=function(){top.layer.close(this.loadingIndex)};return{initNormalPage:function(){e(),t(),i(),a()},initDialogPage:function(){e(),i()},success:o,error:n,info:r,confirm:s,showLoading:c,hideLoading:l}}();jQuery(document).ready(function(){$.ajaxSetup({headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")}})});